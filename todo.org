*** TODO detect and abandon infinite loops
